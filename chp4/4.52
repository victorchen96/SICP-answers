;IF-FAIL
(define (if-fail? exp)
  (tagged-list? exp 'if-fail))
(define (analyze-if-fail exp)
  (let ((pexp (analyze (cadr exp)))
        (pfail (analyze (caddr exp))))
    (lambda (env succeed fail)
      (pexp env 
             (lambda (val fail2)
               (succeed val fail))
             (lambda () (pfail env succeed fail))))))
